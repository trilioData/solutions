#DELETE main FROM vm_security_group_rule_snap_metadata AS main INNER JOIN vm_security_group_rule_snaps AS sub1 INNER JOIN snapshot_vm_resources AS sub2 INNER JOIN snapshots AS sub3 WHERE main.vm_security_group_rule_snap_id = sub1.id AND sub1.vm_security_group_snap_id = sub2.id AND sub2.snapshot_id = sub3.id AND sub3.deleted = 
#SELECT * FROM vm_security_group_rule_snap_metadata AS del_table JOIN (SELECT main.id FROM vm_security_group_rule_snap_metadata AS main INNER JOIN vm_security_group_rule_snaps AS sub1 INNER JOIN snapshot_vm_resources AS sub2 INNER JOIN snapshots AS sub3 WHERE main.vm_security_group_rule_snap_id = sub1.id AND sub1.vm_security_group_snap_id = sub2.id AND sub2.snapshot_id = sub3.id AND sub3.deleted = 1 LIMIT 1) del_select ON del_select.id = del_table.id;
DELETE del_table FROM vm_security_group_rule_snap_metadata AS del_table JOIN (SELECT main.id FROM vm_security_group_rule_snap_metadata AS main INNER JOIN vm_security_group_rule_snaps AS sub1 INNER JOIN snapshot_vm_resources AS sub2 INNER JOIN snapshots AS sub3 WHERE main.vm_security_group_rule_snap_id = sub1.id AND sub1.vm_security_group_snap_id = sub2.id AND sub2.snapshot_id = sub3.id AND sub3.deleted = 1 LIMIT #LIMIT#) del_select ON del_select.id = del_table.id;
